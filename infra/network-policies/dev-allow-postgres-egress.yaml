apiVersion: networking.k8s.io/v1
kind: NetworkPolicy
metadata:
  name: dev-allow-postgres-egress
  namespace: dev
spec:
  podSelector:
    matchExpressions:
      - key: app.kubernetes.io/name
        operator: In
        values:
          - hermes
          - data-handler
          - keycloak
  policyTypes:
    - Egress
  egress:
    - ports:
        - port: 5432
          protocol: TCP
      to:
        - podSelector:
            matchLabels:
              app.kubernetes.io/instance: sec
              app.kubernetes.io/name: postgresql
